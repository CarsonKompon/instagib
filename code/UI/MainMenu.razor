@using System;
@using Sandbox;
@using Sandbox.UI;
@using Instagib.Social;
@namespace Instagib
@inherits PanelComponent

<root class="@((IsPauseMenu && IsHidden) ? "hidden" : "")">
	<MainMenuPanel />
	<SocialBar />
</root>

@code
{
	public static MainMenu Instance { get; private set; }
	[Property] internal SceneFile GameScene { get; set; }
	[Property] public bool IsPauseMenu { get; set; }

	public bool IsHidden = true;

	Angles startingCamRot = Angles.Zero;

	protected override void OnAwake()
	{
		Instance = this;
	}

	protected override void OnStart()
	{
		startingCamRot = Scene.Camera.Transform.Rotation;
	}

	protected override void OnFixedUpdate()
	{
		if (IsPauseMenu)
		{
			if (Input.EscapePressed)
			{
				Input.EscapePressed = false;
				IsHidden = !IsHidden;
			}
		}

		Scene.Camera.Transform.Rotation = startingCamRot + new Angles(
		MathF.Cos(Time.Now * 0.45f) * 2f,
		MathF.Sin(Time.Now * 0.5f) * 2f,
		0f
		);
	}

	protected override int BuildHash() => System.HashCode.Combine(IsHidden);
}